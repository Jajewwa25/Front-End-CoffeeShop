<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link rel="stylesheet" href="../css/cart.css">
</head>
<body>
    <header>
        <h1>Shopping Cart</h1>
    </header>

    
    <main>

        <script>
                function removeItem(itemId, price) {
                    var item = document.getElementById(itemId);
                    if (item) {
                        var itemPrice = parseFloat(item.querySelector('.item-price').textContent.replace('฿', ''));
                        var totalPrice = parseFloat(document.getElementById('total-amount').textContent.replace('฿', ''));
                        totalPrice -= itemPrice;
                        document.getElementById('total-amount').textContent = '฿' + totalPrice.toFixed(2);
                        item.remove();
                    }
                }
            
                // JavaScript function to calculate total price of items in the cart
                function calculateTotal() {
                    var totalPrice = 0;
                    var itemPrices = document.querySelectorAll('.item-price');
                    itemPrices.forEach(function(item) {
                        var price = parseFloat(item.textContent.replace('฿', ''));
                        totalPrice += price;
                    });
                    document.getElementById('total-amount').textContent = '฿' + totalPrice.toFixed(2);
                }
            
                // Call the calculateTotal function when the page loads
                window.onload = calculateTotal;
            
                // JavaScript function to remove an item from the shopping cart and update total price
                function removeItem(itemId, price) {
                    var item = document.getElementById(itemId);
                    if (item) {
                        var itemPrice = parseFloat(item.querySelector('.item-price').textContent.replace('฿', ''));
                        var totalPrice = parseFloat(document.getElementById('total-amount').textContent.replace('฿', ''));
                        totalPrice -= itemPrice;
                        document.getElementById('total-amount').textContent = '฿' + totalPrice.toFixed(2);
                        item.remove();
                        // Call calculateTotal function to update total price after removing item
                        calculateTotal();
                    }
                }
        
        </script>
    
        <h2>Your Cart</h2>

        <div id="shopping-cart">
            <% for (let i = 0; i < cart.length; i++) { %>
            <div id="item">
                <p><%=cart[i].itemname%></p>
                <span class="item-qrt"><%=cart[i].qty%></span>
                <span class="item-price"><%=cart[i].price%></span>
        
                <button class="checkout-btn" onclick="removeItem('item')" >Remove Item</button>
            </div>
            <br>
            <% } %>
        </div>

        <div class="cart-total">
            <h3>Total:</h3>
            <span id="total-amount">฿0.00</span>
        </div>
        <center>
        <button class="checkout-btn"><a href="/menu">Back</a></button>
        <button class="checkout-btn"><a href="order">Pay</a></button>
    </center>
    </main>
</body>
</html>

